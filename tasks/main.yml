---

- name: prepare
  ansible.builtin.include_tasks: prepare.yml

- name: detect mariadb version
  ansible.builtin.include_tasks: detect_mariadb_version.yml

- name: install
  ansible.builtin.include_tasks: installation.yml

- name: configure
  ansible.builtin.include_tasks: configure.yml

- name: secure installation
  ansible.builtin.include_tasks: secure-installation.yml

- name: monitoring
  ansible.builtin.include_tasks: monitoring.yml

- name: databases
  ansible.builtin.include_tasks: databases.yml

- name: users
  ansible.builtin.include_tasks: users.yml

- name: replication
  ansible.builtin.include_tasks: replication.yml
  when:
    - (mariadb_replication.enabled is defined and mariadb_replication.enabled)
    - (mariadb_replication.role is defined and mariadb_replication.role | length > 0)
    - mariadb_replication.role in ['primary', 'replica']

- name: service
  ansible.builtin.include_tasks: service.yml

...
